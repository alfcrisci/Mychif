stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_simple_maize.jpg"),dpi=300)
ggplot(tab$mat_op, aes(Concentration_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_maize.jpg"),dpi=300)
if (tab$N_conc > 0) {
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "Concentration_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_full_maize.jpg"),dpi=300)
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
print(descdist
(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500))
dev.off()
}
}
if (tab$N_mtot > 0) {
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "meanTot_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_full_maize.jpg"),dpi=300)
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500))
dev.off()
}
}
z=z+1;
}
}
maize_tab=data.frame(names=do.call("rbind",res_maize_names),do.call("rbind",res_maize_tab))
file.remove("Tabella_maize.xls")
XLConnect::writeWorksheetToFile("Tabella_maize.xls",maize_tab,"maize")
U_param
res_maize_data
do.call("rbind",res_maize_tab)
seq_along(U_param)
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type[1:2])){
tab=info_extract_db(MAIZE,U_param[i],U_type[j],"maize")
res_maize_data[[z]]=tab
res_maize_tab[[z]]=tab$ls_tab
res_maize_names[[z]]=paste0(U_param[i],";",U_type[j],";","maize")
z=z+1;
}
}
res_maize_tab
res_maize_tab=list()
res_maize_data=list()
res_maize_names=list()
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type[1:2])){
tab=info_extract_db(MAIZE,U_param[i],U_type[j],"maize")
res_maize_data[[z]]=tab
res_maize_tab[[z]]=tab$ls_tab
res_maize_names[[z]]=paste0(U_param[i],";",U_type[j],";","maize")
z=z+1;
}
}
maize_tab=data.frame(names=do.call("rbind",res_maize_names),do.call("rbind",res_maize_tab))
maize_tab
U_type[j]
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type[1:2])){
tab=info_extract_db(MAIZE,U_param[i],U_type[j],"maize")
if (tab$N_conc > 0) {
ggplot(tab$mat_op, aes(Concentration_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_maize.jpg"),dpi=300)
##############################################################################################################################
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "Concentration_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_full_maize.jpg"),dpi=300)
##############################################################################################################################
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500))
dev.off()
}
}
if (tab$N_mtot > 0) {
ggplot(tab$mat_op, aes(meanTot_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_maize.jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "meanTot_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_full_maize.jpg"),dpi=300)
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500))
dev.off()
}
}
z=z+1;
}
}
z
as.numeric(na.omit(tab$mat_op$Concentration_op))
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type[1:2])){
tab=info_extract_db(MAIZE,U_param[i],U_type[j],"maize")
if (tab$N_conc > 0) {
ggplot(tab$mat_op, aes(Concentration_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_maize.jpg"),dpi=300)
##############################################################################################################################
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "Concentration_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_full_maize.jpg"),dpi=300)
##############################################################################################################################
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500))
dev.off()
}
}
if (tab$N_mtot > 0) {
ggplot(tab$mat_op, aes(meanTot_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_maize.jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "meanTot_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_full_maize.jpg"),dpi=300)
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
print(descdist(as.numeric(na.omit(tab$mat_op$meanTot_op)),boot=500))
dev.off()
}
}
z=z+1;
}
}
z
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500)))
dev.off()
}
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$meanTot_op)),boot=500)))
dev.off()
}
MAIZE=readRDS("matrix_data/MAIZE.rds")
#MAIZE$paramType=tolower(MAIZE$paramType)
#MAIZE$sampMatType=tolower(MAIZE$sampMatType)
#MAIZE$sampMatbased=tolower(MAIZE$sampMatbased)
U_param=unique(MAIZE$paramType)
U_type=unique(MAIZE$sampMatType)
U_plant=unique(MAIZE$sampMatbased)[1]
#########################################################################################################
res_maize_tab=list()
res_maize_num=list()
res_maize_data=list()
res_maize_names=list()
#########################################################################################################
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type[1:2])){
tab=info_extract_db(MAIZE,U_param[i],U_type[j],"maize")
res_maize_data[[z]]=tab
res_maize_tab[[z]]=tab$ls_tab
res_maize_names[[z]]=paste0(U_param[i],";",U_type[j],";","maize")
z=z+1;
}
}
maize_tab=data.frame(names=do.call("rbind",res_maize_names),do.call("rbind",res_maize_tab))
file.remove("Tabella_maize.xls")
XLConnect::writeWorksheetToFile("Tabella_maize.xls",maize_tab,"maize")
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type[1:2])){
tab=info_extract_db(MAIZE,U_param[i],U_type[j],"maize")
if (tab$N_conc > 0) {
ggplot(tab$mat_op, aes(Concentration_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_maize.jpg"),dpi=300)
##############################################################################################################################
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "Concentration_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_full_maize.jpg"),dpi=300)
##############################################################################################################################
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500)))
dev.off()
}
}
if (tab$N_mtot > 0) {
ggplot(tab$mat_op, aes(meanTot_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = "maize")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_maize.jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),labelx = "meanTot_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_full_maize.jpg"),dpi=300)
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$meanTot_op)),boot=500)))
dev.off()
}
}
z=z+1;
}
}
dir.create("myco_mais_plot")
setwd("/home/alf/Scrivania/lav_michyf/distrib")
source("aux_distrib.r")
##################################################################################
SMALLGRAINS=readRDS("matrix_data/SMALLGRAINS.rds")
query_vec=unlist(strsplit("almond;barley;buckwheat;caraway;cereals;durum wheat;millet;oat;peanuts;rye;soft wheat;soy;spelt;triticale;walnuts;wheat",";"))
query="barley"
dir.create(paste0("ecdf_simple_SMALLGRAINS","_",query))
dir.create(paste0("ecdf_full_SMALLGRAINS","_",query))
SMALLGRAINSq=SMALLGRAINS[which(SMALLGRAINS$sampMatbased==query),]
SMALLGRAINSq$paramType=gsub("/-","_",tolower(SMALLGRAINSq$paramType))
SMALLGRAINSq$sampMatType=tolower(SMALLGRAINSq$sampMatType)
SMALLGRAINSq$sampMatbased=tolower(SMALLGRAINSq$sampMatbased)
U_param=unique(SMALLGRAINSq$paramType)
U_param
SMALLGRAINS=readRDS("matrix_data/SMALLGRAINS.rds")
SMALLGRAINSq=SMALLGRAINS[which(SMALLGRAINS$sampMatbased==query),]
SMALLGRAINSq$paramType=gsub("/-","_",tolower(SMALLGRAINSq$paramType))
U_param=unique(SMALLGRAINSq$paramType)
U_type=c("food","feed")
U_plant=unique(SMALLGRAINSq$sampMatbased)[1]
U_plant
U_param
SMALLGRAINS
SMALLGRAINSq$paramType
SMALLGRAINS=readRDS("matrix_data/SMALLGRAINS.rds")
SMALLGRAINSq=SMALLGRAINS[which(SMALLGRAINS$sampMatbased==query),]
SMALLGRAINSq$paramType=gsub("/-","_",SMALLGRAINSq$paramType)
SMALLGRAINSq$paramType
U_param=unique(SMALLGRAINSq$paramType)
U_param
U_param=unique(SMALLGRAINSq$paramType)
U_type=c("food","feed")
U_plant=unique(SMALLGRAINSq$sampMatbased)[1]
#########################################################################################################
res_SMALLGRAINS_tab=list()
res_SMALLGRAINS_data=list()
res_SMALLGRAINS_names=list()
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type[1:2])){
tab=info_extract_db(MAIZE,U_param[i],U_type[j],"maize")
res_maize_data[[z]]=tab
res_maize_tab[[z]]=tab$ls_tab
res_maize_names[[z]]=paste0(U_param[i],";",U_type[j],";","maize")
z=z+1;
}
}
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type)){
tab=info_extract_db(SMALLGRAINSq,U_param[i],U_type[j],query)
res_SMALLGRAINS_data[[z]]=tab
res_SMALLGRAINS_tab[[z]]=tab$ls_tab
res_SMALLGRAINS_names[[z]]=paste0(U_param[i],";",U_type[j],";",paste(query,"on",U_type[j]))
}
}
SMALLGRAINSq_tab=data.frame(names=do.call("rbind",res_SMALLGRAINS_names),do.call("rbind",res_SMALLGRAINS_tab))
SMALLGRAINSq_tab
res_SMALLGRAINS_tab=list()
res_SMALLGRAINS_data=list()
res_SMALLGRAINS_names=list()
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type)){
tab=info_extract_db(SMALLGRAINSq,U_param[i],U_type[j],query)
res_SMALLGRAINS_data[[z]]=tab
res_SMALLGRAINS_tab[[z]]=tab$ls_tab
res_SMALLGRAINS_names[[z]]=paste0(U_param[i],";",U_type[j],";",paste(query,"on",U_type[j]))
z=z+1
}
}
SMALLGRAINSq_tab=data.frame(names=do.call("rbind",res_SMALLGRAINS_names),do.call("rbind",res_SMALLGRAINS_tab))
file.remove(paste0("Tabella_SMALLGRAINS_",query,".xls"))
XLConnect::writeWorksheetToFile(paste0("Tabella_SMALLGRAINS_",query,".xls"),SMALLGRAINSq_tab,query)
dir()
SMALLGRAINSq_tab
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type)){
tab=info_extract_db(SMALLGRAINSq,U_param[i],U_type[j],query)
if (tab$N_conc > 0) {
ggplot(tab$mat_op, aes(Concentration_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = query)
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_SMALLGRAINS_",query,".jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),subtitleg=query,labelx = "Concentration_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_full_SMALLGRAINS_",query,".jpg"),dpi=300)
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500)))
dev.off()
}
}
if (tab$N_mtot > 0) {
ggplot(tab$mat_op, aes(meanTot_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = query)
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_simple_SMALLGRAINS_",query,".jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),subtitleg=query,labelx = "meanTot_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_full_SMALLGRAINS_",query,".jpg"),dpi=300)
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$meanTot_op)),boot=500)))
dev.off()
}
}
z=z+1;
}
}
}
dir.create(paste0("ecdf_simple_SMALLGRAINS","_",query,"/plot_simple"))
dir.create(paste0("SMALLGRAINS_plots/","plot_",query,"/plot_simple"))
dir.create(paste0("SMALLGRAINS_plots/","plot_",query,"/plot_full"))
SMALLGRAINSq=SMALLGRAINS[which(SMALLGRAINS$sampMatbased==query),]
SMALLGRAINSq$paramType=gsub("/-","_",SMALLGRAINSq$paramType)
paste0("SMALLGRAINS_plots/","plot_",query,"/plot_simple")
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_simple"))
dir.create(paste0("SMALLGRAINS_plots"))
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_simple"))
dir.create(paste0("SMALLGRAINS_plots/",query))
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_simple"))
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_full"))
system(paste0("mv *full*",query,"*.jpg SMALLGRAINS_plots/",query,"/plot_full"))
system(paste0("mv *full*",query,"*.jpg SMALLGRAINS_plots/",query,"/plot_full"))
########################################################################
library(XLConnect)
library(ggplot2)
library(dplyr)
library(scales)
library(fitdistrplus)
########################################################################
setwd("/home/alf/Scrivania/lav_michyf/distrib")
source("aux_distrib.r")
##################################################################################
SMALLGRAINS=readRDS("matrix_data/SMALLGRAINS.rds")
##################################################################################
query_vec=unlist(strsplit("almond;barley;buckwheat;caraway;cereals;durum wheat;millet;oat;peanuts;rye;soft wheat;soy;spelt;triticale;walnuts;wheat",";"))
##################################################################################
dir.create(paste0("SMALLGRAINS_plots"))
for ( query in query_vec) {
dir.create(paste0("SMALLGRAINS_plots/",query))
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_simple"))
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_full"))
SMALLGRAINSq=SMALLGRAINS[which(SMALLGRAINS$sampMatbased==query),]
SMALLGRAINSq$paramType=gsub("/-","_",SMALLGRAINSq$paramType)
#SMALLGRAINSq$sampMatType=tolower(SMALLGRAINSq$sampMatType)
#SMALLGRAINSq$sampMatbased=tolower(SMALLGRAINSq$sampMatbased)
U_param=unique(SMALLGRAINSq$paramType)
U_type=c("food","feed")
U_plant=unique(SMALLGRAINSq$sampMatbased)[1]
#########################################################################################################
res_SMALLGRAINS_tab=list()
res_SMALLGRAINS_data=list()
res_SMALLGRAINS_names=list()
#########################################################################################################
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type)){
tab=info_extract_db(SMALLGRAINSq,U_param[i],U_type[j],query)
res_SMALLGRAINS_data[[z]]=tab
res_SMALLGRAINS_tab[[z]]=tab$ls_tab
res_SMALLGRAINS_names[[z]]=paste0(U_param[i],";",U_type[j],";",paste(query,"on",U_type[j]))
z=z+1
}
}
SMALLGRAINSq_tab=data.frame(names=do.call("rbind",res_SMALLGRAINS_names),do.call("rbind",res_SMALLGRAINS_tab))
file.remove(paste0("Tabella_SMALLGRAINS_",query,".xls"))
XLConnect::writeWorksheetToFile(paste0("Tabella_SMALLGRAINS_",query,".xls"),SMALLGRAINSq_tab,query)
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type)){
tab=info_extract_db(SMALLGRAINSq,U_param[i],U_type[j],query)
if (tab$N_conc > 0) {
ggplot(tab$mat_op, aes(Concentration_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = query)
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_SMALLGRAINS_",query,".jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),subtitleg=query,labelx = "Concentration_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_full_SMALLGRAINS_",query,".jpg"),dpi=300)
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500)))
dev.off()
}
}
if (tab$N_mtot > 0) {
ggplot(tab$mat_op, aes(meanTot_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = query)
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_simple_SMALLGRAINS_",query,".jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),subtitleg=query,labelx = "meanTot_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_full_SMALLGRAINS_",query,".jpg"),dpi=300)
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot.jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$meanTot_op)),boot=500)))
dev.off()
}
}
z=z+1;
}
}
}
################################################################################################################################
for ( query in query_vec) {
system(paste0("mv *simple*",query,"*.jpg SMALLGRAINS_plots/",query,"/plot_simple"))
}
for ( query in query_vec) {
system(paste0("mv *full*",query,"*.jpg SMALLGRAINS_plots/",query,"/plot_full"))
}
install.packages("VGAM")
setwd("/home/alf/Scrivania/lav_michyf/distrib")
source("aux_distrib.r")
##################################################################################
SMALLGRAINS=readRDS("matrix_data/SMALLGRAINS.rds")
##################################################################################
query_vec=unlist(strsplit("almond;barley;buckwheat;caraway;cereals;durum wheat;millet;oat;peanuts;rye;soft wheat;soy;spelt;triticale;walnuts;wheat",";"))
##################################################################################
dir.create(paste0("SMALLGRAINS_plots"))
for ( query in query_vec) {
dir.create(paste0("SMALLGRAINS_plots/",query))
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_simple"))
dir.create(paste0("SMALLGRAINS_plots/",query,"/plot_full"))
SMALLGRAINSq=SMALLGRAINS[which(SMALLGRAINS$sampMatbased==query),]
SMALLGRAINSq$paramType=gsub("/-","_",SMALLGRAINSq$paramType)
#SMALLGRAINSq$sampMatType=tolower(SMALLGRAINSq$sampMatType)
#SMALLGRAINSq$sampMatbased=tolower(SMALLGRAINSq$sampMatbased)
U_param=unique(SMALLGRAINSq$paramType)
U_type=c("food","feed")
U_plant=unique(SMALLGRAINSq$sampMatbased)[1]
#########################################################################################################
res_SMALLGRAINS_tab=list()
res_SMALLGRAINS_data=list()
res_SMALLGRAINS_names=list()
#########################################################################################################
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type)){
tab=info_extract_db(SMALLGRAINSq,U_param[i],U_type[j],query)
res_SMALLGRAINS_data[[z]]=tab
res_SMALLGRAINS_tab[[z]]=tab$ls_tab
res_SMALLGRAINS_names[[z]]=paste0(U_param[i],";",U_type[j],";",paste(query,"on",U_type[j]))
z=z+1
}
}
SMALLGRAINSq_tab=data.frame(names=do.call("rbind",res_SMALLGRAINS_names),do.call("rbind",res_SMALLGRAINS_tab))
file.remove(paste0("Tabella_SMALLGRAINS_",query,".xls"))
XLConnect::writeWorksheetToFile(paste0("Tabella_SMALLGRAINS_",query,".xls"),SMALLGRAINSq_tab,query)
z=1
for ( i in seq_along(U_param)) {
for ( j in seq_along(U_type)){
tab=info_extract_db(SMALLGRAINSq,U_param[i],U_type[j],query)
if (tab$N_conc > 0) {
ggplot(tab$mat_op, aes(Concentration_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = query)
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_simple_SMALLGRAINS_",query,".jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),subtitleg=query,labelx = "Concentration_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_conc_full_SMALLGRAINS_",query,".jpg"),dpi=300)
if(length(na.omit(tab$mat_op$Concentration_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot_",query,".jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$Concentration_op)),boot=500)))
dev.off()
}
}
if (tab$N_mtot > 0) {
ggplot(tab$mat_op, aes(meanTot_op))+
stat_ecdf(geom = "point")+
ylab("Density")+
ggtitle(paste(U_param[i],"on",U_type[j]),subtitle = query)
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_simple_SMALLGRAINS_",query,".jpg"),dpi=300)
smooth_ecd_gray(as.data.frame(tab$mat_op),titleg = paste(U_param[i],"on",U_type[j]),subtitleg=query,labelx = "meanTot_op")
ggsave(filename = paste0(U_param[i],"_on_",U_type[j],"_mtot_full_SMALLGRAINS_",query,".jpg"),dpi=300)
if(length(na.omit(tab$mat_op$meanTot_op)) > 4)
{jpeg(filename = paste0(U_param[i],"_on_",U_type[j],"_culley_graph_mtot_",query,".jpg"),width = 800, height = 800)
try(print(descdist(as.numeric(na.omit(tab$mat_op$meanTot_op)),boot=500)))
dev.off()
}
}
z=z+1;
}
}
}
################################################################################################################################
for ( query in query_vec) {
system(paste0("mv *simple*",query,"*.jpg SMALLGRAINS_plots/",query,"/plot_simple"))
}
for ( query in query_vec) {
system(paste0("mv *full*",query,"*.jpg SMALLGRAINS_plots/",query,"/plot_full"))
}
dir.create("SMALLGRAINS_plots/culley_graphs")
system(paste0("mv *culley*.jpg ","SMALLGRAINS_plots/culley_graphs"))
