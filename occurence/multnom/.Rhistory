devtools::install_github("alfcrisci/rBiometeo")
library(rBiometeo)
windchill(-4,5)
devtools::install_github("alfcrisci/rBiometeo")
devtools::install_github("alfcrisci/rBiometeo")
devtools::install_github("klutometis/roxygen")
remove.packages("rBiometeo", lib="~/R/x86_64-pc-linux-gnu-library/3.6")
devtools::install_github("alfcrisci/rBiometeo")
library(rBiometeo)
library(rBiometeo,quietly=T)
library(rBiometeo)
remotes::devtools::install_github("alfcrisci/rBiometeo")
remotes::install_github("alfcrisci/rBiometeo")
remove.packages("rBiometeo", lib="~/R/x86_64-pc-linux-gnu-library/3.6")
remotes::install_github("alfcrisci/rBiometeo")
library(rBiometeo)
remove.packages("rBiometeo", lib="~/R/x86_64-pc-linux-gnu-library/3.6")
remotes::install_github("alfcrisci/rBiometeo")
library(rBiometeo)
windchill(-4,5)
remotes::install_github("alfcrisci/rBiometeo")
V8
devtools::install_github("r-lib/vroom")
devtools::install_github("rstudio/r2d3")
remotes::install_github("alfcrisci/rBiometeo")
devtools::install_github("alfcrisci/rBiometeo")
remove.packages("rBiometeo", lib="~/R/x86_64-pc-linux-gnu-library/3.6")
remove.packages("rBiometeo", lib="~/R/x86_64-pc-linux-gnu-library/3.6")
remove.packages("rBiometeo", lib="~/R/x86_64-pc-linux-gnu-library/3.6")
devtools::install_github("alfcrisci/rBiometeo")
#############################################################################################
# MIT License
#  Copyright (c)  MICHYF project
#  @authors Cortinas J, Palumbo R , Crisci A and Toscano P.
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
#############################################################################################
################################     MAIZE          ######################################
library(readxl)
library(ggplot2)
library(multcomp)
library(nnet)
library(XLConnect)
library(dplyr)
plants=excel_sheets("co_occurrence_multinomial_4_12_2019.xlsx")
################################     MAIZE          ######################################
i<-2
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,FB,AF) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
maize<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,maize))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,FB,AF) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   BARLEY   ##################################################
i<-1
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
barley<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,barley))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   OAT   ##################################################
i<-3
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
#XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
#}
#sink()
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
oat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,oat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   OAT   ##################################################
i<-3
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
oat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,oat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   WHEAT   ##################################################
i<-4
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
wheat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,wheat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
plants=excel_sheets("co_occurrence_multinomial_4_12_2019.xlsx")
setwd("/home/alf/Scrivania/lav_michyf/repositories/Mychif/occurence/multnom")
library(readxl)
library(ggplot2)
library(multcomp)
library(nnet)
library(XLConnect)
library(dplyr)
plants=excel_sheets("co_occurrence_multinomial_4_12_2019.xlsx")
i<-2
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,FB,AF) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
maize<-colSums(out)/dim(out)[1]
maize
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,maize))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,FB,AF) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
barley<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,barley))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   OAT   ##################################################
i<-3
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
#XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
#}
#sink()
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
oat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,oat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   OAT   ##################################################
i<-3
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
oat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,oat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   WHEAT   ##################################################
i<-4
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
wheat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,wheat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
i<-1
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
setwd("/home/alf/Scrivania/lav_michyf/repositories/Mychif/occurence/multnom")
################################     MAIZE          ######################################
library(readxl)
library(ggplot2)
library(multcomp)
library(nnet)
library(XLConnect)
library(dplyr)
plants=excel_sheets("co_occurrence_multinomial_4_12_2019.xlsx")
################################     MAIZE          ######################################
i<-2
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,FB,AF) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
maize<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,maize))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,FB,AF) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   BARLEY   ##################################################
i<-1
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
barley<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,barley))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   OAT   ##################################################
i<-3
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
#XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
#}
#sink()
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
oat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,oat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   OAT   ##################################################
i<-3
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
oat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,oat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
############################   WHEAT   ##################################################
i<-4
plant=read_xlsx("co_occurrence_multinomial_4_12_2019.xlsx",i)
plant_data=plant[which(!is.na(plant$COUNT)),]
plant_data=plant_data %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=sum(COUNT))
y<-as.matrix(plant_data[,1:3])
plant_model=multinom(formula = y~1, weights= COUNT, data = plant_data)
cat(paste("Modeling ", plants[i],"\n"))
cat(paste(formula_model,"\n"))
print(summary(plant_model))
out=as.data.frame(fitted.values(plant_model))
names(out)=names(plant_data)[1:3]
XLConnect::writeWorksheetToFile("res_multinomial.xls",out,plants[i])
### Simulating samples taken and the presence of one of the micotoxin ###
### Estimating the multinomial probability for maize from Literature ###
wheat<-colSums(out)/dim(out)[1]
### Number of simulations ###
nsim<-1000
### Setting the seed ###
set.seed(12345)
### Generating presence abscense of each of the micotoxins in each sample ###
sampleCooccu<-(t(rmultinom(nsim,3,wheat))>0)*1
### Summary table describing the amount of samples with one two or three micotoxins present ###
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,NIV,ZEN) %>% summarize(COUNT=n()/nsim)
sampleCooccu[1:10,]
sampleCooccu<-(t(rmultinom(nsim,3,oat))>0)*1
(t(rmultinom(nsim,3,oat))>0)*1
able(rowSums(sampleCooccu))
table(rowSums(sampleCooccu))
data.frame(sampleCooccu) %>% group_by(DON,T2_HT2,NIV) %>% summarize(COUNT=n()/nsim)
oat<-colSums(out)/dim(out)[1]
oat
